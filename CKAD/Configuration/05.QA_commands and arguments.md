# ðŸ§© Kubernetes Lab: Commands & Arguments

---

### ðŸŽ¯ **Objective**

Understand how to define, modify, and override **commands** and **arguments** for containers in Kubernetes Pods â€” and how they relate to Dockerfile instructions like `ENTRYPOINT` and `CMD`.

---

## ðŸ§  Concept Refresher

| Dockerfile Instruction | Kubernetes Field | Purpose                                              |
| ---------------------- | ---------------- | ---------------------------------------------------- |
| ENTRYPOINT             | `command`        | Defines the executable run when the container starts |
| CMD                    | `args`           | Provides default parameters passed to ENTRYPOINT     |

ðŸ”¹ **In Docker:**
`docker run ubuntu-sleeper sleep 5`

ðŸ”¹ **In Kubernetes Pod YAML:**

```yaml
command: ["sleep"]
args: ["5"]
```

---

## ðŸ§ª Lab Tasks & Questions

---

### **Q1. How many pods exist on the system?**

```bash
kubectl get pods
```

âœ… **Output Example:**

```
NAME              READY   STATUS    RESTARTS   AGE
ubuntu-sleeper    1/1     Running   0          10s
```

âœ… **Answer:** There is **1 pod** running on the system.

---

### **Q2. What is the command used to run the pod?**

Inspect the pod definition:

```bash
kubectl describe pod ubuntu-sleeper | grep -A2 "Containers"
```

or view YAML:

```bash
kubectl get pod ubuntu-sleeper -o yaml
```

âœ… **Answer:** The command used is `sleep`.

---

### **Q3. Create a pod with the Ubuntu image to run a container that sleeps for 5000 seconds.**

Create a pod definition file named **`ubuntu-sleeper2.yaml`**:

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: ubuntu-sleeper2
spec:
  containers:
  - name: ubuntu
    image: ubuntu
    command: ["sleep"]
    args: ["5000"]
```

Apply it:

```bash
kubectl apply -f ubuntu-sleeper2.yaml
```

âœ… **Verification:**

```bash
kubectl get pods
```

Status should be **Running**.

---

### **Q4. Create another pod using file `ubuntu-sleeper3.yaml` and update it to sleep for 2000 seconds.**

```bash
kubectl edit pod ubuntu-sleeper3
```

Change:

```yaml
args: ["5000"]
```

to:

```yaml
args: ["2000"]
```

Save and close (`:wq`).

âœ… **Verification:**

```bash
kubectl get pods
```

Pod should restart with new configuration.

---

### **Q5. Inspect a Dockerfile under `/root/webapp-color/Dockerfile`**

Open it:

```bash
cat /root/webapp-color/Dockerfile
```

Example content:

```Dockerfile
FROM python:3.9
ENTRYPOINT ["python", "app.py"]
CMD ["blue"]
```

âœ… **Question:** What command is run when the container starts?

**Answer:**
By default, the container executes:

```
python app.py blue
```

ENTRYPOINT (`python app.py`) + CMD (`blue`)

---

### **Q6. Inspect the two files under `/root/webapp-color2`**

View both:

```bash
cat /root/webapp-color2/Dockerfile
cat /root/webapp-color2/pod.yaml
```

#### **Dockerfile**

```Dockerfile
FROM python:3.9
ENTRYPOINT ["python", "app.py"]
CMD ["red"]
```

#### **Pod Definition**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: webapp-color
spec:
  containers:
  - name: webapp
    image: webapp-color:latest
    command: ["color"]
    args: ["green"]
```

âœ… **Question:** What final command runs when the pod starts?

**Answer:**
`command` in the pod overrides ENTRYPOINT.
`args` overrides CMD.
Final command:

```
color green
```

The `ENTRYPOINT` and `CMD` from Dockerfile are completely overridden.

---

### **Q7. Inspect `/root/webapp-color3`**

```bash
cat /root/webapp-color3/Dockerfile
cat /root/webapp-color3/pod.yaml
```

#### **Dockerfile**

```Dockerfile
FROM python:3.9
ENTRYPOINT ["python", "app.py"]
CMD ["blue"]
```

#### **Pod Definition**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: webapp-color3
spec:
  containers:
  - name: webapp
    image: webapp-color3:latest
    command: ["python"]
    args: ["pink"]
```

âœ… **Final command executed:**

```
python pink
```

(both `command` and `args` override the Dockerfile)

---

### **Q8. Create a pod that by default displays a blue background, and change it to green using command-line args.**

ðŸ“„ **pod.yaml**

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: webapp-green
spec:
  containers:
  - name: webapp
    image: webapp-color
    args: ["green"]
```

Deploy:

```bash
kubectl apply -f pod.yaml
```

âœ… The application now launches with **green background**.

---

## ðŸ§¾ **Key Takeaways**

* `command` in Kubernetes YAML = Dockerfile `ENTRYPOINT`
* `args` in Kubernetes YAML = Dockerfile `CMD`
* `command` **overrides ENTRYPOINT**, `args` **override CMD**
* You can dynamically change container behavior using command/args without rebuilding the image.

---

## ðŸ§© **Quick Practice Q&A**

| Question                                                            | Answer                                           |
| ------------------------------------------------------------------- | ------------------------------------------------ |
| What happens if both ENTRYPOINT and CMD are defined in Dockerfile?  | CMD values are passed as arguments to ENTRYPOINT |
| How do you override CMD in Kubernetes?                              | Use `args` in Pod spec                           |
| How do you override ENTRYPOINT in Kubernetes?                       | Use `command` in Pod spec                        |
| Which has higher precedence â€” Dockerfile ENTRYPOINT or Pod command? | Pod command                                      |
| Whatâ€™s the result of using both command and args in a Pod?          | The final startup command = `command + args`     |

---
