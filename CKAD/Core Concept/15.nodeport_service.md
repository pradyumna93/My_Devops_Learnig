### **üîå NodePort Service (Detailed Example)**

A **NodePort** service maps:

* A **port on each node** to a **port on the Pod**.

#### Example:

* **Pod Port (targetPort):** `80`
* **Service Port (port):** `80`
* **Node Port (nodePort):** `30008` (range: `30000‚Äì32767`)

You can access the app using:

```
http://<NodeIP>:30008
```

---

### **üìÑ Service Definition File Structure**

Every Service YAML file has the following structure:

```yaml
apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  type: NodePort
  selector:
    app: myapp
  ports:
    - port: 80
      targetPort: 80
      nodePort: 30008
```

**Explanation:**

* **type:** Specifies the service type (`NodePort`, `ClusterIP`, or `LoadBalancer`)
* **selector:** Links the service to the matching Pods using labels
* **ports:** Defines the mapping between service and pod ports
* **targetPort:** Pod‚Äôs actual application port
* **nodePort:** Exposed port on each node

Only `port` is mandatory ‚Äî others will be automatically assigned if omitted.

---

### **üîñ Linking Pods and Services (Selectors & Labels)**

Services use **labels** to identify which Pods to route traffic to.

If your Pod was created with:

```yaml
labels:
  app: myapp
```

Then your Service must include:

```yaml
selector:
  app: myapp
```

This automatically connects the Service to all Pods with that label.

---

### **üöÄ Creating and Viewing a Service**

#### **Create from YAML:**

```bash
kubectl apply -f service-definition.yaml
```

#### **Create directly from command:**

```bash
kubectl expose pod webapp --type=NodePort --port=80
```

#### **View all services:**

```bash
kubectl get services
```

This will show:

* **NAME**
* **TYPE**
* **CLUSTER-IP**
* **EXTERNAL-IP (if applicable)**
* **PORT(S)**
* **AGE**

---

### **üåê Accessing the Application**

After creating the NodePort service:

```bash
curl http://192.168.1.2:30008
```

or open the same address in a browser to access your app externally.

---

### **‚öñÔ∏è Load Balancing Across Multiple Pods**

If multiple Pods share the same label (`app: myapp`), the service:

* Automatically identifies all matching Pods
* Distributes traffic across them using a **random load-balancing algorithm**

‚úÖ No extra configuration is needed ‚Äî Services automatically adapt when Pods are added or removed.

---

### **üèóÔ∏è Multi-node Cluster Behavior**

If your Pods are spread across multiple nodes:

* The **same NodePort** is opened on **every node**
* You can access your application using **any node‚Äôs IP** and the **same port**

Example:

```bash
curl http://192.168.1.3:30008
curl http://192.168.1.4:30008
```

Both commands reach the same application.

---
